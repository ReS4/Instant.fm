{% extends "base.html" %}

{% block bodyId %}p{% end %}

{% block body %}
  <header class="clearfix" id="header">
    <a class="ir" href="/" id="headerLogo">
      <h1>Instant.fm - Share Music Playlists Instantly</h1>
    </a>
  
    <nav>
      <a href="#new">New Playlist</a>
      <a href="/search" rel="partial search" id="searchLink" title="Search Instant.fm">Search</a>
      <a href="#myLists">My Playlists</a>
      <a id="registrationLink" href="#signUp">Sign up</a>
    </nav>
  </header>
  <div class="clearfix" id="main"> 
       
    <section id="playlistDisplay">
    
      <div id="videoDiv">
        <div id="player">&nbsp;</div>
      </div>
      
      <div id="playlistDiv">
        <ul id="playlist">
          <!-- Loaded via JS -->
        </ul>
      </div>
      
      <div id="playlistToolbar">
        <div class="left">
          <a href="#toggleVideo" class="on" id="toggleVideo"><span>Show Video</span></a>
          <a href="#toggleShuffle" id="toggleShuffle"><span>Shuffle</span></a>
          <a href="#toggleRepeat" id="toggleRepeat"><span>Repeat</span></a>
        </div>
        <div class="right"></div>
      </div>
      
    </section> <!-- end of #playlistDisplay -->
  
    <section id="browserDisplay">
      
      <div class="front">
        
        <header class="iPhoneHeader" id="nowPlayingHeader">
          <span class="left"><!-- dynamic back button --></span>
          <h1>Now Playing</h1>
          <a class="right" href="#flip">Search</a>
        </header>
        
        <div id="nowPlayingContainer">
          
          <section id="nowPlaying" class="slide">
            <section id="curPlaylist">
              <header class="clearfix">
                <h2 id="curPlaylistTitle">&nbsp;</h2>
              </header>
              <article>
                <span id="curPlaylistDesc">&nbsp;</span>
              </article>

              <section id="playlistActions">
                <a href="#addComment" id="addComment" class="awesome white">
                  Add a Comment
                </a>
                <a href="#fbShare" id="fbShare" class="darkblue awesome">
                  Share on Facebook
                </a>
                <a href="#twShare" id="twShare" class="blue awesome">
                  Share on Twitter
                </a>
              </section> <!-- end of #playlistActions -->

              <!-- <a href="#TODO" id="curPlaylistAuthor">
                <img alt="Feross Aboukhadijeh" src="/images/profilepic.jpg" />
                <div>Feross Aboukhadijeh</div>
              </a> -->
            </section>

            <!-- Facebook comments are loaded with JS here -->

            <section id="curPlaying">
              <header>
                <h3>Currently Playing</h3>
              </header>
              <div class="clearfix" id="curAlbumBlock">
                <div id="curAlbumImg">
                  <span class="zoomIcon">&nbsp;</span>
                </div>
                <div id="curAlbumInfo">
                  <div id="curSong">
                    <h4>&nbsp;</h4>
                  </div>
                  <div id="curArtist">
                    <span class="curLabel">by</span> 
                    <h4>&nbsp;</h4>
                  </div>
                  <div id="curAlbum">
                    <span class="curLabel">on</span> 
                    <h4>&nbsp;</h4>
                  </div>
                  <div id="curLyric"></div>
                </div>
                <!-- <fb:like href="http://dev.instant.fm/#" show_faces="false" width="300" colorscheme="dark"></fb:like> -->
              </div> <!-- end of #curAlbumBlock -->

              <div id="curDescs">
                <section id="curSongDesc">
                  <h4>&nbsp;</h4> 
                  <article>&nbsp;</article>
                </section>
                <section class="artistDesc">
                  <h4>&nbsp;</h4>
                  <span class="artistImg" id="curArtistImg">
                    <span class="zoomIcon">&nbsp;</span>
                  </span>
                  <article>&nbsp;</article>
                </section>
              </div> <!-- end of #curDescs -->

            </section> <!-- end of #curPlaying -->

          </section> <!-- end of #nowPlaying -->
              
        </div> <!-- end of #nowPlayingContainer -->
        
      </div> <!-- end of #front -->
      
      <div class="back">
        
        <header class="iPhoneHeader" id="browserHeader">
          <span class="left"><!-- dynamic back button --></span>
          <h1>Now Playing</h1>
          <a class="right" href="#flip">Now Playing</a>
        </header>
        
        <div id="browser">
          <div id="FS_slider">
            <div id="FS_holder">
              {% block mini-browser %}
              {% end %}
            </div> <!-- end of #FS_holder -->
          </div> <!-- end of #FS_slider -->
        </div> <!-- end of #browser -->
        
      </div> <!-- end of #back -->
     
    </section> <!-- end of #browserDisplay -->

  </div> <!-- end of #main -->
  
  <footer id="footer">
    <strong><a href="#">Instant.fm</a></strong> |
    <a href="#">FAQ</a> |
    <a href="#">Blog</a> |
    <a href="#">Contact</a>
    <a href="#helpBox" id="helpLink">Keyboard shortcuts available</a>
  </footer>

  <div class="invisible" id="devNull">
    <div id="curAlbumImgZoom">&nbsp;</div>
    <div id="curArtistImgZoom">&nbsp;</div>
  
    <div id="helpBox">
      <div class="fancyZoomHeader">Keyboard shortcuts</div>
      
      <section class="helpSection">
        <div class="fancyZoomSectionHeader">Playback Control</div>
        <dl class="clearfix shortcut">
          <dt class="key">space</dt>
          <dd class="action">Play/pause</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">&larr;</dt>
          <dt class="key">&rarr;</dt>
          <dd class="action">Previous/next song</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">+</dt>
          <dt class="key">-</dt>
          <dd class="action">Increase/decrease volume</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">S</dt>
          <dd class="action">Toggle shuffle</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">R</dt>
          <dd class="action">Toggle repeat song</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">V</dt>
          <dd class="action">Toggle video display</dd>
        </dl>
      </section>
      <section class="helpSection">
        <div class="fancyZoomSectionHeader">Playlist Editing</div>
        <dl class="clearfix shortcut">
          <dt class="key">A</dt>
          <dd class="action">Add songs</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">K</dt>
          <dd class="action">Move current song up</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">J</dt>
          <dd class="action">Move current song down</dd>
        </dl>
      </section>
      <section class="helpSection">
        <div class="fancyZoomSectionHeader">Navigation</div>
        <dl class="clearfix shortcut">
          <dt class="key">L</dt>
          <dd class="action">Go to Current Song</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">ESC</dt>
          <dd class="action">Go back one page</dd>
        </dl>
        <dl class="clearfix shortcut">
          <dt class="key">?</dt>
          <dd class="action">Bring up this help dialog</dd>
        </dl>
      </section>
    </div> <!-- end of #helpBox -->
    
    <div id="registrationBox">
      <div class="fancyZoomHeader">Log In or Sign Up</div>
      <div class="loginForm">
        <div class="fancyZoomSectionHeader"> Login to Instant.fm </div>
        <div class="formRow">
          <label> Email Address: </label>
          <input type="text" name="email" value="" />
        </div>
        <div class="formRow">
          <label> Password: </label>
          <input type="password" name="password" value="" />
        </div>
        <div class="formRow">
          <input type="checkbox" name="allow_passwordless" checked="checked" />
          <label> Let me login without a password on this browser </label>
        </div>
      </div>
      <div class="loginForm">
        <div class="fancyZoomSectionHeader"> Create an Account </div>
        <div id="fbConnectButton">
          <a id="loginButton" class="small darkblue awesome"> Connect your Facebook Account </a>
        </div>
        <div id="fbAccountCreation" style="display:none;">
          <form id="fbRegistration" method="post">
            <div class="loginForm">
              <div id="registrationErrors"></div>
              <div class="formRow">
                <label for="fbName"> Display Name: </label>
                <input id="fbName" type="text" name="name" value="" maxlength="32"/>
              </div>         
              <div class="formRow">
                <label for="fbEmail"> E-mail: </label>
                <input id="fbEmail" type="text" name="email" />
              </div>          
              <div class="formRow">
                <label for="fbPassword"> Password: </label>
                <input id="fbPassword" type="password" name="password" />
              </div>          
            </div>
            <div>
              <img id="fbProfileImage"></img>
            </div>
            <input type="hidden" name="auth_token"></input>
            <input type="hidden" name="fb_user_id"></input>
            {{ xsrf_form_html() }}
            <a id="submitFbRegistration" class="small grey awesome" onclick="$('form#fbRegistration').submit();">Finish</a>
          </div>
       </form>
      </div>
    </div>
          
  </div> <!-- end of #devNull -->
{% end %}

{% block scripts %}
  {% block scripts-partial %}{% end %}
  <script>
    var initial_playlist = {{ playlist.replace('<', '\u003c').replace('>', '\u003e') if playlist else 'null' }};
      $(function() {
          onloadPlaylist();
      });
  </script>
{% end %}